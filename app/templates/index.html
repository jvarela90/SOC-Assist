{% extends "base.html" %}
{% block title %}Inicio{% endblock %}

{% block content %}

<!-- ‚îÄ‚îÄ Notification banners (shown on login) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
{% if notifications %}
<div class="mb-4">
  {% set overdue = notifications | selectattr('notif_type', 'eq', 'asset_review_overdue') | list %}
  {% set upcoming = notifications | selectattr('notif_type', 'eq', 'asset_review_upcoming') | list %}

  {% if overdue %}
  <div class="alert alert-danger border-danger d-flex align-items-center gap-3 mb-2" role="alert">
    <i class="bi bi-exclamation-triangle-fill fs-3 flex-shrink-0"></i>
    <div class="flex-grow-1">
      <strong class="d-block fs-6">{{ overdue[0].title }}</strong>
      <span class="small">{{ overdue[0].body }}</span>
    </div>
    <div class="d-flex gap-2 flex-shrink-0">
      <a href="/activos?review_due=1" class="btn btn-sm btn-danger">Ver activos</a>
      <form method="post" action="/api/notifications/mark-read" class="d-inline">
        <button type="submit" class="btn btn-sm btn-outline-light">Marcar le√≠do</button>
      </form>
    </div>
  </div>
  {% endif %}

  {% if upcoming %}
  <div class="alert alert-warning border-warning d-flex align-items-center gap-3 mb-2" role="alert">
    <i class="bi bi-clock-history fs-3 flex-shrink-0 text-warning"></i>
    <div class="flex-grow-1">
      <strong class="d-block fs-6">{{ upcoming[0].title }}</strong>
      <span class="small">{{ upcoming[0].body }}</span>
    </div>
    <div class="d-flex gap-2 flex-shrink-0">
      <a href="/activos?review_due=1" class="btn btn-sm btn-warning text-dark">Ver activos</a>
      <form method="post" action="/api/notifications/mark-read" class="d-inline">
        <button type="submit" class="btn btn-sm btn-outline-dark">Marcar le√≠do</button>
      </form>
    </div>
  </div>
  {% endif %}

  {% for notif in notifications %}{% if notif.notif_type not in ('asset_review_overdue','asset_review_upcoming') %}
  <div class="alert alert-info border-info d-flex align-items-center gap-3 mb-2" role="alert">
    <i class="bi bi-info-circle-fill fs-4 flex-shrink-0"></i>
    <div class="flex-grow-1">
      <strong class="d-block">{{ notif.title }}</strong>
      {% if notif.body %}<span class="small">{{ notif.body }}</span>{% endif %}
    </div>
  </div>
  {% endif %}{% endfor %}
</div>
{% endif %}
<!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->

<div class="row justify-content-center mt-4">
  <div class="col-lg-9">

    <!-- Hero -->
    <div class="text-center mb-5">
      <div class="mb-3">
        <i class="bi bi-shield-shaded text-danger" style="font-size: 5rem;"></i>
      </div>
      <h1 class="display-5 fw-bold">SOC <span class="text-danger">Assist</span></h1>
      <p class="lead text-muted">
        Plataforma de <strong>Alerta Temprana en Ciberseguridad</strong><br>
        Detecta, eval√∫a y escala eventos de seguridad ‚Äî incluso sin experiencia t√©cnica.
      </p>
      <div class="d-flex justify-content-center gap-3 mt-4">
        <a href="/evaluar" class="btn btn-danger btn-lg px-5">
          <i class="bi bi-play-circle-fill me-2"></i>Iniciar Evaluaci√≥n
        </a>
        <a href="/dashboard" class="btn btn-outline-secondary btn-lg px-4">
          <i class="bi bi-bar-chart-fill me-2"></i>Ver Dashboard
        </a>
      </div>
    </div>

    <!-- Info cards -->
    <div class="row g-4 mb-5">
      <div class="col-md-4">
        <div class="card h-100 border-secondary">
          <div class="card-body text-center p-4">
            <i class="bi bi-person-fill-check text-success fs-1 mb-3"></i>
            <h5 class="card-title">Para Todo Nivel</h5>
            <p class="card-text text-muted small">
              Dise√±ado para que cualquier persona ‚Äî sin conocimientos t√©cnicos ‚Äî pueda detectar se√±ales de alerta y saber si debe escalar el evento.
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card h-100 border-secondary">
          <div class="card-body text-center p-4">
            <i class="bi bi-cpu-fill text-primary fs-1 mb-3"></i>
            <h5 class="card-title">Motor Inteligente</h5>
            <p class="card-text text-muted small">
              Motor de reglas ponderado con <strong>63+ preguntas</strong>, multiplicadores de riesgo y reglas de corte autom√°ticas. Configurable por administradores.
            </p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card h-100 border-secondary">
          <div class="card-body text-center p-4">
            <i class="bi bi-graph-up-arrow text-warning fs-1 mb-3"></i>
            <h5 class="card-title">Explicabilidad Total</h5>
            <p class="card-text text-muted small">
              Cada resultado explica <strong>por qu√©</strong> se clasific√≥ as√≠, qu√© factores pesaron m√°s, y qu√© hacer a continuaci√≥n.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Levels of severity -->
    <div class="card border-secondary mb-5">
      <div class="card-header">
        <h6 class="mb-0"><i class="bi bi-ladder me-2"></i>Niveles de Clasificaci√≥n</h6>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-dark table-bordered mb-0">
            <thead>
              <tr>
                <th>Nivel</th>
                <th>Score</th>
                <th>Qu√© significa</th>
                <th>Acci√≥n recomendada</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="badge bg-success">üü¢ Informativo</span></td>
                <td>0‚Äì30</td>
                <td>Evento de bajo riesgo, posiblemente normal</td>
                <td>Monitorear y documentar</td>
              </tr>
              <tr>
                <td><span class="badge bg-warning text-dark">üü° Sospechoso</span></td>
                <td>31‚Äì70</td>
                <td>Algo no parece bien, requiere atenci√≥n</td>
                <td>Investigar y recolectar evidencia</td>
              </tr>
              <tr>
                <td><span class="badge" style="background:#fd7e14">üü† Incidente</span></td>
                <td>71‚Äì130</td>
                <td>Evento de seguridad confirmado</td>
                <td>Escalar al equipo de seguridad</td>
              </tr>
              <tr>
                <td><span class="badge bg-danger">üî¥ Cr√≠tico</span></td>
                <td>131‚Äì200</td>
                <td>Incidente de alto impacto en curso</td>
                <td>Escalar a gerencia e iniciar IR</td>
              </tr>
              <tr>
                <td><span class="badge" style="background:#6f1a1a">üö® Brecha</span></td>
                <td>201+</td>
                <td>Posible brecha de seguridad confirmada</td>
                <td>Activar plan de respuesta completo</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Quick start -->
    <div class="text-center">
      <h5 class="text-muted mb-3">¬øDetectaste algo sospechoso?</h5>
      <a href="/evaluar" class="btn btn-danger btn-lg px-5">
        <i class="bi bi-search-heart-fill me-2"></i>Comenzar Evaluaci√≥n Ahora
      </a>
    </div>

  </div>
</div>
{% endblock %}
